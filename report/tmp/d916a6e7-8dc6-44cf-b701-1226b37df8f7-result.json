{"name": "test3", "status": "broken", "statusDetails": {"message": "PermissionError: [Errno 13] Permission denied: 'C:\\\\Users\\\\Administrator\\\\.jenkins\\\\workspace\\\\psimsendemail\\\\untitled\\\\report\\\\test_report.xlsx'", "trace": "def test3():\n      # 追加内容来自于该文件\n      tpl_sheet_name = 'register'\n      wb_tpl = load_workbook(data)\n      ws_tpl = wb_tpl[tpl_sheet_name]\n    \n      # 要保留的文件\n      wb = load_workbook(data_res)\n      # active会选择你打开时选中的sheet表，如果有多个sheet表不确定时，建议使用wb['sheet_name']\n      # ws = wb.active\n      ws = wb['register']\n      max_row = ws.max_row\n    \n      cur_row = 0\n      for row in ws_tpl:\n        cur_row += 1\n        for cell in row:\n          # 复制值\n          # ws[cell.coordinate].value = cell.value\n          try:\n            pos = f'{cell.column_letter}{max_row + cur_row}'\n          except Exception as e:\n            continue\n          ws[pos].value = cell.value\n          ws[pos].data_type = copy(cell.data_type)\n    \n          if cell.has_style:\n            # 复制字体，填充，对齐，边框\n            ws[pos].font = copy(cell.font)\n            ws[pos].fill = copy(cell.fill)\n            ws[pos].number_format = copy(cell.number_format)\n            ws[pos].alignment = copy(cell.alignment)\n            ws[pos].border = copy(cell.border)\n    \n            if cell.comment:\n              # 复制备注\n              ws[pos].comment = copy(cell.comment)\n    \n      # 复制合并单元格\n      for x in ws_tpl.merged_cells.ranges:\n        match = re.search(r'([a-zA-Z]+)(\\d+):([a-zA-Z]+)(\\d+)', x.coord)\n        col_1, row_1, col_2, row_2 = match.groups()\n        new_coord = f'{col_1}{int(row_1) + max_row}:{col_2}{int(row_2) + max_row}'\n        ws.merge_cells(range_string=new_coord)\n    \n      # 保存\n>     wb.save(data_res)\n\ntest_1.py:86: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n..\\..\\..\\..\\..\\AppData\\Roaming\\Python\\Python36\\site-packages\\openpyxl\\workbook\\workbook.py:392: in save\n    save_workbook(self, filename)\n..\\..\\..\\..\\..\\AppData\\Roaming\\Python\\Python36\\site-packages\\openpyxl\\writer\\excel.py:291: in save_workbook\n    archive = ZipFile(filename, 'w', ZIP_DEFLATED, allowZip64=True)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <zipfile.ZipFile [closed]>\nfile = 'C:\\\\Users\\\\Administrator\\\\.jenkins\\\\workspace\\\\psimsendemail\\\\untitled\\\\report\\\\test_report.xlsx'\nmode = 'w', compression = 8, allowZip64 = True\n\n    def __init__(self, file, mode=\"r\", compression=ZIP_STORED, allowZip64=True):\n        \"\"\"Open the ZIP file with mode read 'r', write 'w', exclusive create 'x',\n        or append 'a'.\"\"\"\n        if mode not in ('r', 'w', 'x', 'a'):\n            raise ValueError(\"ZipFile requires mode 'r', 'w', 'x', or 'a'\")\n    \n        _check_compression(compression)\n    \n        self._allowZip64 = allowZip64\n        self._didModify = False\n        self.debug = 0  # Level of printing: 0 through 3\n        self.NameToInfo = {}    # Find file info given name\n        self.filelist = []      # List of ZipInfo instances for archive\n        self.compression = compression  # Method of compression\n        self.mode = mode\n        self.pwd = None\n        self._comment = b''\n    \n        # Check if we were passed a file-like object\n        if isinstance(file, os.PathLike):\n            file = os.fspath(file)\n        if isinstance(file, str):\n            # No, it's a filename\n            self._filePassed = 0\n            self.filename = file\n            modeDict = {'r' : 'rb', 'w': 'w+b', 'x': 'x+b', 'a' : 'r+b',\n                        'r+b': 'w+b', 'w+b': 'wb', 'x+b': 'xb'}\n            filemode = modeDict[mode]\n            while True:\n                try:\n>                   self.fp = io.open(file, filemode)\nE                   PermissionError: [Errno 13] Permission denied: 'C:\\\\Users\\\\Administrator\\\\.jenkins\\\\workspace\\\\psimsendemail\\\\untitled\\\\report\\\\test_report.xlsx'\n\n..\\..\\..\\..\\..\\AppData\\Local\\Programs\\Python\\Python36\\lib\\zipfile.py:1090: PermissionError"}, "start": 1657632907569, "stop": 1657632907625, "uuid": "7cc57155-36e2-492c-a5b4-4e3a3f82e112", "historyId": "540eb3b4a0d671d07525dd10e2a6682b", "testCaseId": "d3831ea1b53a4435e71e3d73f635ce50", "fullName": "test_1#test3", "labels": [{"name": "suite", "value": "test_1"}, {"name": "host", "value": "MS-SLSXLICKSUSF"}, {"name": "thread", "value": "3944-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_1"}]}